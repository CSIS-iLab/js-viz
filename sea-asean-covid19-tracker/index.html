<html>
  <head>
    <!--JQuery CDN from Google Hosted Libraries-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> 

    <!--DataTables.net library and css-->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.20/r-2.2.3/datatables.min.css"/>
    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.20/r-2.2.3/datatables.min.js"></script>


    <!--Import Tabletop to use for reading Google spreadsheet-->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>

    <!--Use Tabletop and Datatables to read Google Spreadsheet-->
    <script type='text/javascript'>    
      var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1FaJQvGn-DjUNyFPyAkurQrBlVULRJ2GHFDEJ0cjolHw/edit?usp=sharing';
      
      /*init() and showInfo() are from Tabletop, with the addition of displayInfo to use Datatables*/
      function init() {
        Tabletop.init( { 
          key: publicSpreadsheetUrl,
          callback: showInfo,
          parseNumbers: true,
          simpleSheet: true } )
      }

      function showInfo(data, tabletop) {
        console.log(data)
        console.log(tabletop.modelNames[0])
        let lastUpdatedEl = document.getElementById("lastUpdated")
        lastUpdatedEl.innerHTML = tabletop.modelNames[0]
        displayInfo(data)
      }

      
      /*function to use Datatables to display data */
      function displayInfo(dataset) {
        $('#example').DataTable( {
          responsive: true,
          data: dataset,
          columns: [
            { title: 'Country', data: 'Country' },
            { title: 'Total Cases', data: 'Total Cases', className:'dt-body-right' },
            { title: 'Cases Last 24hr', data: 'Cases Last 24hr', className: 'dt-body-right' },
            { title: 'Total Deaths', data: 'Total Deaths', className: 'dt-body-right' },
            { title: '# Tests', data: '# Tests', className: 'dt-body-right' },
            { title: '# Recovered', data: '# Recovered', className: 'dt-body-right' },
            { title: 'Cases per Million', data: 'Cases per Million', className: 'dt-body-right' },
            { title: 'Total Population', data: 'Total Population', className: 'dt-body-right' }
          ],
          paging: false,
          searching: false,
          info: false
        });
      } 
      
      window.addEventListener('DOMContentLoaded', init)

    </script>
  </head>
  <body>
    <table id="example" class="display compact" style="max-width:800px;">
    </table>
    <tfoot>
      <span id="lastUpdated"></span>  
      <span>Source Info</span>
    </tfoot>
  </body>
</html>
